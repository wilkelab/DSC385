{
  "hash": "75866ae42689a88cc4f65e1f8eef15eb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data wrangling 1\"\nauthor: \"Claus O. Wilke\"\ndate: last-modified\nformat: \n  revealjs:\n    theme:\n      - default\n      - Wilke-theme.scss\n    auto-stretch: false\n    chalkboard: true\nexecute:\n  fig-format: svg\n  fig-asp: 0.618\n  fig-width: 5.5\n---\n\n\n\n\n\n\n## Elementary data manipulations\n\n::: {.incremental}\n- Pick rows: `filter()`\n- Pick columns: `select()`\n- Sort rows: `arrange()`\n- Count things: `count()`\n- Make new columns: `mutate()`\n:::\n\n# But first: the pipe operator `|>`\n\n# `|>` is pronounced \"and then\"\n\n## The pipe `|>` feeds data into functions\n\n::: {.fragment .small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins) # loads the `penguins` dataset\n\nhead(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 8\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n1 Adelie  Torgersen           39.1          18.7               181        3750\n2 Adelie  Torgersen           39.5          17.4               186        3800\n3 Adelie  Torgersen           40.3          18                 195        3250\n4 Adelie  Torgersen           NA            NA                  NA          NA\n5 Adelie  Torgersen           36.7          19.3               193        3450\n6 Adelie  Torgersen           39.3          20.6               190        3650\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## The pipe `|>` feeds data into functions\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins) # loads the `penguins` dataset\n\n# head(penguins)\npenguins |>\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 8\n  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n  <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n1 Adelie  Torgersen           39.1          18.7               181        3750\n2 Adelie  Torgersen           39.5          17.4               186        3800\n3 Adelie  Torgersen           40.3          18                 195        3250\n4 Adelie  Torgersen           NA            NA                  NA          NA\n5 Adelie  Torgersen           36.7          19.3               193        3450\n6 Adelie  Torgersen           39.3          20.6               190        3650\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## The pipe `|>` feeds data into functions\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(penguins, aes(bill_length_mm, bill_depth_mm, color = species)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![&nbsp;](data-wrangling-1_files/figure-revealjs/penguins-scatter-1.svg){width=60%}\n:::\n:::\n\n\n\n:::\n\n## The pipe `|>` feeds data into functions\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  ggplot(aes(bill_length_mm, bill_depth_mm, color = species)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![&nbsp;](data-wrangling-1_files/figure-revealjs/penguins-scatter2-1.svg){width=60%}\n:::\n:::\n\n\n\n:::\n\n## Old-school \"magrittr\" pipe: `%>%`\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>%\n  ggplot(aes(bill_length_mm, bill_depth_mm, color = species)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![&nbsp;](data-wrangling-1_files/figure-revealjs/penguins-scatter3-1.svg){width=60%}\n:::\n:::\n\n\n\n:::\n\n\n## Which to use? Native pipe or old-school pipe?\n\n::: {.incremental}\n- The native pipe `|>` is the future. I'll be using it throughout.\n- The magrittr `%>%` works fine. You can use it if you llike to.\n:::\n\n<!-- Segment ends here -->\n\n# Picking rows or columns, and sorting\n\n## Pick rows from a table: `filter()`\n\n::: {.move-down-2em}\n![](../assets/data-wrangling-1/filter.svg){fig-align=\"center\" width=\"75%\"}\n:::\n\n## Filter out penguins of species Gentoo\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(species == \"Gentoo\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 124 × 8\n   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>           <dbl>         <dbl>             <int>       <int>\n 1 Gentoo  Biscoe           46.1          13.2               211        4500\n 2 Gentoo  Biscoe           50            16.3               230        5700\n 3 Gentoo  Biscoe           48.7          14.1               210        4450\n 4 Gentoo  Biscoe           50            15.2               218        5700\n 5 Gentoo  Biscoe           47.6          14.5               215        5400\n 6 Gentoo  Biscoe           46.5          13.5               210        4550\n 7 Gentoo  Biscoe           45.4          14.6               211        4800\n 8 Gentoo  Biscoe           46.7          15.3               219        5200\n 9 Gentoo  Biscoe           43.3          13.4               209        4400\n10 Gentoo  Biscoe           46.8          15.4               215        5150\n# ℹ 114 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Filter out penguins with bill length > 50 mm\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(bill_length_mm > 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 52 × 8\n   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>           <dbl>         <dbl>             <int>       <int>\n 1 Gentoo  Biscoe           50.2          14.3               218        5700\n 2 Gentoo  Biscoe           59.6          17                 230        6050\n 3 Gentoo  Biscoe           50.5          15.9               222        5550\n 4 Gentoo  Biscoe           50.5          15.9               225        5400\n 5 Gentoo  Biscoe           50.1          15                 225        5000\n 6 Gentoo  Biscoe           50.4          15.3               224        5550\n 7 Gentoo  Biscoe           54.3          15.7               231        5650\n 8 Gentoo  Biscoe           50.7          15                 223        5550\n 9 Gentoo  Biscoe           51.1          16.3               220        6000\n10 Gentoo  Biscoe           52.5          15.6               221        5450\n# ℹ 42 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Pick columns from a table: `select()`\n\n::: {.move-down-2em}\n![](../assets/data-wrangling-1/select.svg){fig-align=\"center\" width=\"75%\"}\n:::\n\n\n## Pick columns `species`, `island`, and `sex`\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  select(species, island, sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 3\n   species island    sex   \n   <fct>   <fct>     <fct> \n 1 Adelie  Torgersen male  \n 2 Adelie  Torgersen female\n 3 Adelie  Torgersen female\n 4 Adelie  Torgersen <NA>  \n 5 Adelie  Torgersen female\n 6 Adelie  Torgersen male  \n 7 Adelie  Torgersen female\n 8 Adelie  Torgersen male  \n 9 Adelie  Torgersen <NA>  \n10 Adelie  Torgersen <NA>  \n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Sort the rows in a table: `arrange()`\n\n::: {.move-down-2em}\n![](../assets/data-wrangling-1/arrange.svg){fig-align=\"center\" width=\"75%\"}\n:::\n\n## Sort penguins by bill length, ascending\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  arrange(bill_length_mm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Dream               32.1          15.5               188        3050\n 2 Adelie  Dream               33.1          16.1               178        2900\n 3 Adelie  Torgersen           33.5          19                 190        3600\n 4 Adelie  Dream               34            17.1               185        3400\n 5 Adelie  Torgersen           34.1          18.1               193        3475\n 6 Adelie  Torgersen           34.4          18.4               184        3325\n 7 Adelie  Biscoe              34.5          18.1               187        2900\n 8 Adelie  Torgersen           34.6          21.1               198        4400\n 9 Adelie  Torgersen           34.6          17.2               189        3200\n10 Adelie  Biscoe              35            17.9               190        3450\n# ℹ 334 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Sort penguins by bill length, descending\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  arrange(desc(bill_length_mm))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   species   island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>     <fct>           <dbl>         <dbl>             <int>       <int>\n 1 Gentoo    Biscoe           59.6          17                 230        6050\n 2 Chinstrap Dream            58            17.8               181        3700\n 3 Gentoo    Biscoe           55.9          17                 228        5600\n 4 Chinstrap Dream            55.8          19.8               207        4000\n 5 Gentoo    Biscoe           55.1          16                 230        5850\n 6 Gentoo    Biscoe           54.3          15.7               231        5650\n 7 Chinstrap Dream            54.2          20.8               201        4300\n 8 Chinstrap Dream            53.5          19.9               205        4500\n 9 Gentoo    Biscoe           53.4          15.8               219        5500\n10 Chinstrap Dream            52.8          20                 205        4550\n# ℹ 334 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n:::\n\n<!-- Segment ends here -->\n\n# Counting things\n\n## Count things\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 334 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Count things\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  count(species)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 2\n  species       n\n  <fct>     <int>\n1 Adelie      152\n2 Chinstrap    68\n3 Gentoo      124\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Count things\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  count(species, island)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 3\n  species   island        n\n  <fct>     <fct>     <int>\n1 Adelie    Biscoe       44\n2 Adelie    Dream        56\n3 Adelie    Torgersen    52\n4 Chinstrap Dream        68\n5 Gentoo    Biscoe      124\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Use the pipe to build analysis pipelines\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(species == \"Adelie\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 152 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 142 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Use the pipe to build analysis pipelines\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(species == \"Adelie\") |>\n  select(island, sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 152 × 2\n   island    sex   \n   <fct>     <fct> \n 1 Torgersen male  \n 2 Torgersen female\n 3 Torgersen female\n 4 Torgersen <NA>  \n 5 Torgersen female\n 6 Torgersen male  \n 7 Torgersen female\n 8 Torgersen male  \n 9 Torgersen <NA>  \n10 Torgersen <NA>  \n# ℹ 142 more rows\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Use the pipe to build analysis pipelines\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(species == \"Adelie\") |>\n  select(island, sex) |>\n  count(island, sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 3\n  island    sex        n\n  <fct>     <fct>  <int>\n1 Biscoe    female    22\n2 Biscoe    male      22\n3 Dream     female    27\n4 Dream     male      28\n5 Dream     <NA>       1\n6 Torgersen female    24\n7 Torgersen male      23\n8 Torgersen <NA>       5\n```\n\n\n:::\n:::\n\n\n\n:::\n\n<!-- Segment ends here -->\n\n# Adding new columns to a table\n\n## Make a new table column: `mutate()`\n\n::: {.move-down-2em}\n![](../assets/data-wrangling-1/mutate.svg){fig-align=\"center\" width=\"75%\"}\n:::\n\n## Example: flipper length in cm\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  select(species, island, flipper_length_mm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 3\n   species island    flipper_length_mm\n   <fct>   <fct>                 <int>\n 1 Adelie  Torgersen               181\n 2 Adelie  Torgersen               186\n 3 Adelie  Torgersen               195\n 4 Adelie  Torgersen                NA\n 5 Adelie  Torgersen               193\n 6 Adelie  Torgersen               190\n 7 Adelie  Torgersen               181\n 8 Adelie  Torgersen               195\n 9 Adelie  Torgersen               193\n10 Adelie  Torgersen               190\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Example: flipper length in cm\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  select(species, island, flipper_length_mm) |>\n  mutate(flipper_length_cm = flipper_length_mm / 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 4\n   species island    flipper_length_mm flipper_length_cm\n   <fct>   <fct>                 <int>             <dbl>\n 1 Adelie  Torgersen               181              18.1\n 2 Adelie  Torgersen               186              18.6\n 3 Adelie  Torgersen               195              19.5\n 4 Adelie  Torgersen                NA              NA  \n 5 Adelie  Torgersen               193              19.3\n 6 Adelie  Torgersen               190              19  \n 7 Adelie  Torgersen               181              18.1\n 8 Adelie  Torgersen               195              19.5\n 9 Adelie  Torgersen               193              19.3\n10 Adelie  Torgersen               190              19  \n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Make multiple columns at once\n\n::: {.small-font}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  select(species, island, flipper_length_mm) |>\n  mutate(\n    flipper_length_cm = flipper_length_mm / 10,  # <- notice the comma\n    flipper_length_in = flipper_length_mm / 25.4\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 5\n   species island    flipper_length_mm flipper_length_cm flipper_length_in\n   <fct>   <fct>                 <int>             <dbl>             <dbl>\n 1 Adelie  Torgersen               181              18.1              7.13\n 2 Adelie  Torgersen               186              18.6              7.32\n 3 Adelie  Torgersen               195              19.5              7.68\n 4 Adelie  Torgersen                NA              NA               NA   \n 5 Adelie  Torgersen               193              19.3              7.60\n 6 Adelie  Torgersen               190              19                7.48\n 7 Adelie  Torgersen               181              18.1              7.13\n 8 Adelie  Torgersen               195              19.5              7.68\n 9 Adelie  Torgersen               193              19.3              7.60\n10 Adelie  Torgersen               190              19                7.48\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n\n:::\n\n<!-- Segment ends here -->\n\n## Further reading\n\n- R for Data Science: [Chapter 5: Data transformation](https://r4ds.had.co.nz/transform.html)\n- R for Data Science: [Chapter 18: Pipes](https://r4ds.had.co.nz/pipes.html)\n- **dplyr** documentation: [Introduction to dplyr](https://dplyr.tidyverse.org/articles/dplyr.html)\n- **dplyr** reference documentation: [One table verbs](https://dplyr.tidyverse.org/reference/index.html#section-one-table-verbs)\n",
    "supporting": [
      "data-wrangling-1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}